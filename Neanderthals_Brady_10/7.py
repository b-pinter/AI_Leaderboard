{
  "nbformat": 4,
  "nbformat_minor": 0,
  "metadata": {
    "colab": {
      "provenance": []
    },
    "kernelspec": {
      "name": "python3",
      "display_name": "Python 3"
    },
    "language_info": {
      "name": "python"
    },
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "acf0d7f031b549f4a7f77544751ca39e": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_659644bc466141a7aade9486029c2d1d",
            "msg_id": "",
            "outputs": []
          }
        },
        "659644bc466141a7aade9486029c2d1d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "e8f3f1b9541c4c269b70c883fda9350b": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_ed6cb34de2bf4c84b3717dc687c98481",
            "msg_id": "",
            "outputs": []
          }
        },
        "4e479e70c0d04e6bac93f02b13f1cfc6": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_73bd59f0eff34cbfad426c34592d3fc2",
            "msg_id": "",
            "outputs": []
          }
        },
        "73bd59f0eff34cbfad426c34592d3fc2": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "294c606ddfc642878db24d9a164c4365": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_717299311cf54449a2c73346285e9377",
            "msg_id": "",
            "outputs": []
          }
        },
        "717299311cf54449a2c73346285e9377": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "f00ac66a63b540f295d011eacd36c449": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_74b3dc8e9bf04bb085b772a549afbf01",
            "msg_id": "",
            "outputs": []
          }
        },
        "28ab1accb3b94aa3b400e2c475083a67": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_12e2cb724224495bb89c4a226c8bca0d",
            "msg_id": "",
            "outputs": []
          }
        },
        "12e2cb724224495bb89c4a226c8bca0d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "3dd0ec840cad47c2afdb4a962651d1e1": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_6bfd36c400954fc1a5f46badc36094dd",
            "msg_id": "",
            "outputs": []
          }
        },
        "35449266f92844daa16812f0b30d0ab1": {
          "model_module": "@jupyter-widgets/output",
          "model_name": "OutputModel",
          "model_module_version": "1.0.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/output",
            "_model_module_version": "1.0.0",
            "_model_name": "OutputModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/output",
            "_view_module_version": "1.0.0",
            "_view_name": "OutputView",
            "layout": "IPY_MODEL_d3a204a20ebb40c7856a2b5cbb0c61d0",
            "msg_id": "",
            "outputs": []
          }
        }
      }
    }
  },
  "cells": [
    {
      "cell_type": "code",
      "source": [
        "# Uninstall Colab's bigframes because it conflicts with other installs\n",
        "%pip uninstall -y bigframes\n",
        "# Install Lightning, also let's use \"rich\" progress bars\n",
        "%pip install -Uqq lightning wandb rich einops"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Yy8HEEgTDyhU",
        "outputId": "c6e8c4de-b896-4c58-af0f-9d5d945d1dc8"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Found existing installation: bigframes 2.23.0\n",
            "Uninstalling bigframes-2.23.0:\n",
            "  Successfully uninstalled bigframes-2.23.0\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m828.5/828.5 kB\u001b[0m \u001b[31m21.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m19.9/19.9 MB\u001b[0m \u001b[31m65.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m243.4/243.4 kB\u001b[0m \u001b[31m16.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m983.2/983.2 kB\u001b[0m \u001b[31m49.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m832.4/832.4 kB\u001b[0m \u001b[31m45.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
            "\u001b[?25h"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import torch\n",
        "from torch import nn, optim, utils\n",
        "from torch.utils.data import DataLoader\n",
        "from torchvision.datasets import MNIST\n",
        "from torchvision.transforms import ToTensor, RandomAffine, RandomErasing\n",
        "import torchvision\n",
        "import matplotlib.pyplot as plt\n",
        "import torch.nn.functional as F\n",
        "# Not advocating Lightning over raw pytorch, but it offers some useful abstractions\n",
        "import lightning as L\n",
        "from lightning.pytorch.loggers import WandbLogger\n",
        "from lightning.pytorch.callbacks import RichProgressBar\n",
        "import wandb\n",
        "import numpy as np\n",
        "from einops import rearrange"
      ],
      "metadata": {
        "id": "Gu1e9phQEaZb"
      },
      "execution_count": 3,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "# optional: define additional data augmentation transformers for the dataloader\n",
        "train_transforms = torchvision.transforms.Compose([\n",
        "    ToTensor(),\n",
        "    # uncomment next lines for extra augmentations\n",
        "    #RandomAffine(degrees=15, translate=(0.1, 0.1)),\n",
        "    #RandomErasing(p=0.2, scale=(0.02, 0.1))\n",
        "])\n",
        "\n",
        "train_ds = MNIST(root='./data', train=True,  download=True, transform=train_transforms)\n",
        "test_ds  = MNIST(root='./data', train=False, download=True, transform=ToTensor())\n",
        "val_ds = test_ds  #alias val for test\n",
        "print(f\"Data set lengths: train: {len(train_ds)}, test: {len(test_ds)}\")\n",
        "\n",
        "\n",
        "\n",
        "batch_size = 128   # could make this bigger; note for MNIST on Colab we're disk-speed limited, not GPU-limited\n",
        "train_dl = DataLoader(train_ds, batch_size=batch_size, num_workers=2, shuffle=True, persistent_workers=True)\n",
        "test_dl = DataLoader(test_ds, batch_size=batch_size, num_workers=2, shuffle=False, persistent_workers=True)\n",
        "val_dl = test_dl # alias val <--> test"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "j-ViGPJSEULh",
        "outputId": "4f23af1a-d597-44ec-a303-3e1de75ccc73"
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "100%|██████████| 9.91M/9.91M [00:00<00:00, 18.0MB/s]\n",
            "100%|██████████| 28.9k/28.9k [00:00<00:00, 679kB/s]\n",
            "100%|██████████| 1.65M/1.65M [00:00<00:00, 4.46MB/s]\n",
            "100%|██████████| 4.54k/4.54k [00:00<00:00, 6.67MB/s]\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Data set lengths: train: 60000, test: 10000\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "id": "cSC3cKxAB9sW"
      },
      "outputs": [],
      "source": [
        "class SimpleVAEModel(L.LightningModule):\n",
        "    def __init__(self,\n",
        "                 latent_dim=3,    # dimensionality of the latent space. bigger=less compression, better reconstruction\n",
        "                 n_hid=[32, 64, 128],  # simple\n",
        "                 act = nn.LeakyReLU,\n",
        "                 lr=1e-3\n",
        "                 ):\n",
        "        super().__init__()\n",
        "        self.encoder = nn.Sequential(\n",
        "            nn.Conv2d(1, n_hid[0], kernel_size=3, stride=2, padding=1), act(), # 14x14\n",
        "            nn.Conv2d(n_hid[0], n_hid[1], kernel_size=3, stride=2, padding=1), act(), # 7x7\n",
        "            nn.Conv2d(n_hid[1], n_hid[2], kernel_size=7), act(), # 1x1\n",
        "            nn.Flatten(),\n",
        "            nn.Linear(n_hid[2], latent_dim * 2) # *2 b/c mu, log_var\n",
        "        )\n",
        "        self.decoder = nn.Sequential(\n",
        "            nn.Linear(latent_dim, n_hid[2]),\n",
        "            nn.Unflatten(-1, (n_hid[2], 1, 1)),\n",
        "            nn.ConvTranspose2d(n_hid[2], n_hid[1], kernel_size=7), act(), # 7x7\n",
        "            nn.ConvTranspose2d(n_hid[1], n_hid[0], kernel_size=3, stride=2, padding=1, output_padding=1), act(), # 14x14\n",
        "            nn.ConvTranspose2d(n_hid[0], 1, kernel_size=3, stride=2, padding=1, output_padding=1) # 28x28\n",
        "        )\n",
        "        self.latent_dim, self.n_hid, self.act, self.lr = latent_dim, n_hid, act, lr # save for possible use later\n",
        "        self.save_hyperparameters()\n",
        "\n",
        "    def forward(self, x):\n",
        "        # x = x.view(x.size(0), -1)  # Flatten to (batch, 784) - Removed for Conv layers\n",
        "        z = self.encoder(x)\n",
        "        i_half = z.shape[-1]//2\n",
        "        mu, log_var = z[:,:i_half],  z[:,i_half:]\n",
        "        z_hat = mu + torch.randn_like(mu) * torch.exp(0.5*log_var)\n",
        "        x_hat = self.decoder(z_hat)\n",
        "        # x_hat = x_hat.view(x_hat.size(0), 1, 28, 28)  # Reshape back for BCE loss - Not needed for Conv layers\n",
        "        return z, x_hat, mu, log_var, z_hat\n",
        "\n",
        "    def training_step(self, batch, batch_idx):\n",
        "        x, _ = batch\n",
        "        z, x_hat, mu, log_var, z_hat = self(x)\n",
        "        # Reconstruction loss (binary cross-entropy)\n",
        "        recon_loss = F.binary_cross_entropy_with_logits(x_hat, x, reduction='sum')\n",
        "        # KL divergence loss\n",
        "        kl_loss = -0.5 * torch.sum(1 + log_var - mu.pow(2) - log_var.exp())\n",
        "        loss = recon_loss + kl_loss\n",
        "        self.log('train_loss', loss)\n",
        "        return loss\n",
        "\n",
        "    def configure_optimizers(self):\n",
        "        optimizer = optim.Adam(self.parameters(), lr=self.lr)\n",
        "        return optimizer\n",
        "\n",
        "\n",
        "class SimpleFlowModel(nn.Module):\n",
        "    def __init__(self, latent_dim=3, n_hidden=32, n_layers=3, act=nn.LeakyReLU):\n",
        "        super(SimpleFlowModel, self).__init__()\n",
        "        self.latent_dim = latent_dim\n",
        "        self.layers = nn.Sequential(\n",
        "            nn.Linear(latent_dim+1, n_hidden), act(),\n",
        "            *[nn.Sequential(nn.Linear(n_hidden, n_hidden), act()) for _ in range(n_layers-1)],\n",
        "            nn.Linear(n_hidden, latent_dim),)\n",
        "\n",
        "    def forward(self, x, t, act=F.gelu):\n",
        "        t = t.expand(x.size(0), 1)  # Ensure t has the correct dimensions\n",
        "        x = torch.cat([x, t], dim=1)\n",
        "        return self.layers(x)\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "### these next two are identical to blog post\n",
        "@torch.no_grad()\n",
        "def fwd_euler_step(model, current_points, current_t, dt):\n",
        "    velocity = model(current_points, current_t)\n",
        "    return current_points + velocity * dt\n",
        "\n",
        "@torch.no_grad()\n",
        "def integrate_path(model, initial_points, step_fn=fwd_euler_step, n_steps=100,\n",
        "                   save_trajectories=False, warp_fn=None):\n",
        "    \"\"\"this 'sampling' routine is primarily used for visualization.\"\"\"\n",
        "    device = next(model.parameters()).device\n",
        "    current_points = initial_points.clone()\n",
        "    ts =  torch.linspace(0,1,n_steps).to(device)\n",
        "    if warp_fn: ts = warp_fn(ts)\n",
        "    if save_trajectories: trajectories = [current_points]\n",
        "    for i in range(len(ts)-1):\n",
        "        current_points = step_fn(model, current_points, ts[i], ts[i+1]-ts[i])\n",
        "        if save_trajectories: trajectories.append(current_points)\n",
        "    if save_trajectories: return current_points, torch.stack(trajectories).cpu()\n",
        "    return current_points\n",
        "#####\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "class SubmissionInterface(nn.Module):\n",
        "    \"\"\"All teams must implement this for automated evaluation.\n",
        "    When you subclass/implement these methods, replace the NotImplementedError.\"\"\"\n",
        "\n",
        "    def __init__(self):\n",
        "        super().__init__()\n",
        "\n",
        "        #--- REQUIRED INFO:\n",
        "        self.info = {\n",
        "            'team': 'Neanderthals',  # REPLACE with your team name. This will be public\n",
        "            'names': 'Brady, Kenneth, Max', # or single name. This will be kept private\n",
        "        }\n",
        "        self.latent_dim = 3   # TODO: we could just (re)measure this on the fly\n",
        "        #----\n",
        "\n",
        "        # keep support for full auto-initialization:\n",
        "        self.load_vae()\n",
        "        self.load_flow_model()\n",
        "        self.device = 'cpu' # we can change this later via .to()\n",
        "\n",
        "    def load_vae(self):\n",
        "        \"\"\"this completely specifies the vae model including configuration parameters,\n",
        "           downloads/mounts the weights from Google Drive, automatically loads weights\"\"\"\n",
        "        self.vae = SimpleVAEModel(latent_dim=self.latent_dim)\n",
        "        vae_weights_file = 'downloaded_vae.safetensors'\n",
        "        if not os.path.exists(vae_weights_file):\n",
        "            safetensors_link = \"https://drive.google.com/file/d/1N4VS3HKBrXnuQhiud1ruMTFZ5jbhsrIn/view?usp=sharing\"\n",
        "            gdown.download(safetensors_link, vae_weights_file, quiet=False, fuzzy=True)\n",
        "        self.vae.load_state_dict(load_file(vae_weights_file))\n",
        "\n",
        "    def load_flow_model(self):\n",
        "        \"\"\"this completely specifies the flow model including configuration parameters,\n",
        "           downloads/mounts the weights from Google Drive, automatically loads weights\"\"\"\n",
        "        self.flow_model = SimpleFlowModel(latent_dim=self.latent_dim)\n",
        "        flow_weights_file = 'downloaded_flow.safetensors'\n",
        "        if not os.path.exists(flow_weights_file):\n",
        "            safetensors_link = \"https://drive.google.com/file/d/13hlolKEc1QB6wA5M_sSgH8wfKR35fjc9/view?usp=sharing\"\n",
        "            gdown.download(safetensors_link, flow_weights_file, quiet=False, fuzzy=True)\n",
        "        self.flow_model.load_state_dict(load_file(flow_weights_file))\n",
        "\n",
        "    def generate_samples(self, n_samples:int, n_steps=100) -> torch.Tensor:\n",
        "        z0 = torch.randn([n_samples, self.latent_dim]).to(self.device)\n",
        "        z1 = integrate_path(self.flow_model, z0, n_steps=n_steps)\n",
        "        gen_xhat = F.sigmoid(self.decode(z1).view(-1, 28, 28))\n",
        "        return gen_xhat\n",
        "\n",
        "    def encode(self, images: torch.Tensor) -> torch.Tensor:\n",
        "        # if your vae has linear layers, flatten first\n",
        "        # if your vae has conv layers, comment out next line\n",
        "        # images = images.view(images.size(0), -1) # Removed for Conv layers\n",
        "        with torch.no_grad():\n",
        "            z = self.vae.encoder(images.to(self.device))\n",
        "            mu = z[:, :self.latent_dim]  # return only first half (mu)\n",
        "            return mu\n",
        "\n",
        "    def decode(self, latents: torch.Tensor) -> torch.Tensor:\n",
        "        return self.vae.decoder(latents)\n",
        "\n",
        "    def to(self, device):\n",
        "        self.device = device\n",
        "        self.vae.to(self.device)\n",
        "        self.flow_model.to(self.device)\n",
        "        return self\n",
        "\n",
        "\n",
        "# Sample usage:\n",
        "# device = 'cuda' if torch.cuda.is_available() else 'mps' if torch.backends.mps.is_available() else 'cpu'\n",
        "# mysub = SubmissionInterface().to(device) # loads vae and flow models\n",
        "# xhat_gen = mysub.generate_samples(n_samples=10, n_steps=100)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "vae = SimpleVAEModel()\n",
        "model = vae\n",
        "\n",
        "wandb.login()\n",
        "wandb.finish()\n",
        "\n",
        "wandb_logger = WandbLogger(log_model=\"all\", project='my-awesome-project')\n",
        "wandb_logger.watch(model) # this thing complains too much upon re-runs, just ignore it and keep going\n",
        "\n",
        "epochs = 25  # VAEs require more steps to train than vanilla AEs, due to dual-objective loss\n",
        "trainer = L.Trainer(max_epochs=epochs, devices=\"auto\", logger=wandb_logger, callbacks=RichProgressBar(leave=True))\n",
        "trainer.fit(model=vae, train_dataloaders=train_dl, val_dataloaders=val_dl)\n",
        "wandb.finish()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 457,
          "referenced_widgets": [
            "acf0d7f031b549f4a7f77544751ca39e",
            "659644bc466141a7aade9486029c2d1d",
            "e8f3f1b9541c4c269b70c883fda9350b",
            "4e479e70c0d04e6bac93f02b13f1cfc6",
            "73bd59f0eff34cbfad426c34592d3fc2",
            "294c606ddfc642878db24d9a164c4365",
            "717299311cf54449a2c73346285e9377",
            "f00ac66a63b540f295d011eacd36c449",
            "28ab1accb3b94aa3b400e2c475083a67",
            "12e2cb724224495bb89c4a226c8bca0d",
            "3dd0ec840cad47c2afdb4a962651d1e1",
            "35449266f92844daa16812f0b30d0ab1"
          ]
        },
        "id": "GIFIzbwgCNLF",
        "outputId": "e960c52c-ca2f-4f5c-9c85-9a50115a8b4d"
      },
      "execution_count": 6,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "Epoch 24/24 \u001b[38;2;98;6;224m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m 469/469 \u001b[2m0:01:26 • 0:00:00\u001b[0m \u001b[2;4m5.58it/s\u001b[0m \u001b[3mv_num: wur8\u001b[0m\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">Epoch 24/24 <span style=\"color: #6206e0; text-decoration-color: #6206e0\">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> 469/469 <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">0:01:26 • 0:00:00</span> <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f; text-decoration: underline\">5.58it/s</span> <span style=\"font-style: italic\">v_num: wur8</span>\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "INFO: `Trainer.fit` stopped: `max_epochs=25` reached.\n",
            "INFO:lightning.pytorch.utilities.rank_zero:`Trainer.fit` stopped: `max_epochs=25` reached.\n"
          ]
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": []
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": [
              "<br>    <style><br>        .wandb-row {<br>            display: flex;<br>            flex-direction: row;<br>            flex-wrap: wrap;<br>            justify-content: flex-start;<br>            width: 100%;<br>        }<br>        .wandb-col {<br>            display: flex;<br>            flex-direction: column;<br>            flex-basis: 100%;<br>            flex: 1;<br>            padding: 10px;<br>        }<br>    </style><br><div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>epoch</td><td>▁▁▁▂▂▂▂▂▂▂▂▂▂▃▃▄▄▄▄▄▅▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇█</td></tr><tr><td>train_loss</td><td>█▃▃▂▂▂▂▂▂▂▂▃▂▂▁▂▁▁▂▂▂▂▁▁▂▂▂▂▁▁▂▁▁▂▁▂▁▁▁▁</td></tr><tr><td>trainer/global_step</td><td>▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇███</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>epoch</td><td>24</td></tr><tr><td>train_loss</td><td>16557.77148</td></tr><tr><td>trainer/global_step</td><td>11699</td></tr></table><br/></div></div>"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": [
              " View run <strong style=\"color:#cdcd00\">fiery-dust-2</strong> at: <a href='https://wandb.ai/brady-pinter1/my-awesome-project/runs/r1fqwur8' target=\"_blank\">https://wandb.ai/brady-pinter1/my-awesome-project/runs/r1fqwur8</a><br> View project at: <a href='https://wandb.ai/brady-pinter1/my-awesome-project' target=\"_blank\">https://wandb.ai/brady-pinter1/my-awesome-project</a><br>Synced 5 W&B file(s), 1 media file(s), 50 artifact file(s) and 0 other file(s)"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": [
              "Find logs at: <code>./wandb/run-20251008_011800-r1fqwur8/logs</code>"
            ]
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "# @title `test_inference` visualization code\n",
        "@torch.no_grad()\n",
        "def test_inference(model, idx=None, return_fig=False):\n",
        "    import inspect\n",
        "    model.eval()\n",
        "    if idx is None: idx = torch.randint(len(test_ds), (1,))[0]\n",
        "    if isinstance(idx, int): idx = [idx]\n",
        "    elif isinstance(idx, range): idx = list(idx)\n",
        "    x_batch = torch.stack([test_ds[i][0] for i in idx]).to(model.device)  # images\n",
        "    y_batch = torch.tensor([test_ds[i][1] for i in idx]).to(model.device) # labels\n",
        "    # if not model.use_conv: # Removed this line as SimpleVAEModel does not have use_conv\n",
        "    # x_batch = x_batch.view(x_batch.size(0), -1) # Removed for Conv layers\n",
        "    if 1==len(inspect.signature(model.forward).parameters): # for ae or vae\n",
        "        result = model.forward(x_batch)\n",
        "    else:                                                   # c-vae (later in lesson)\n",
        "        cond = F.one_hot(y_batch, num_classes=10).float()\n",
        "        result = model.forward(x_batch, cond)\n",
        "    z, recon = result[:2]\n",
        "    recon = recon.view(len(idx), 28, 28)\n",
        "    fig, axs = plt.subplots(2, len(idx), figsize=(3*len(idx), 4))\n",
        "    if len(idx) == 1: axs = axs.reshape(2, 1)\n",
        "    for i in range(len(idx)):\n",
        "        axs[0,i].imshow(x_batch[i].view(28,28).cpu(), cmap='gray')\n",
        "        axs[1,i].imshow(recon[i].cpu(), cmap='gray')\n",
        "        if i == 0:\n",
        "            axs[0,0].set_ylabel('Input', fontsize=12)\n",
        "            axs[1,0].set_ylabel('Reconstruction', fontsize=12)\n",
        "    model.train()\n",
        "    if return_fig: return fig\n",
        "    plt.show()\n",
        "\n",
        "idx = range(5)\n",
        "test_inference(vae, idx=idx)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 371
        },
        "id": "R_QCOlGKKiaR",
        "outputId": "af793a9b-5608-421e-f332-e00139dbd56f"
      },
      "execution_count": 8,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 1500x400 with 10 Axes>"
            ],
            "image/png": "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0tGfe+45KywstNmzZ9sVV1zRnEMFINDDQHzRv0C80cNAfNG/iKtQX3m7//77bcWKFQ3+/pNPPpH/J70x1qxZY+Xl5VZaWlpXy83NtVNPPdUWLlzY4OP27t1r1dXVCT8Aml9jepj+BaKBORiIN+ZgIL6YgxFloS4o3XvvvbZ8+fIGf79ixQq77777wqyiTnl5uZmZFRYWJtQLCwvrfqdMnjzZcnNz63569+6dkvEASE5jepj+BaKBORiIN+ZgIL6YgxFlTRrKvW3bNpnr0Zxuv/12q6qqqvtZv359WscDwB/9C8QbPQzEF/0LxBs9jOaQdIbSggUL7N13363796uvvmqff/65s1xlZaW99NJLdvzxx4ca4EFFRUVmZlZRUWE9e/asq1dUVMjQ6YNycnIsJycnJWOIg+3btzu1efPmeT3WNyDc1+jRo52aCg3/61//6tReeumllI4F6deYHm5p/auoUF7fC/Wqj+bPnx96TGh5mIObngrqVDZv3tzEI0EmysQ5WAXZv/jii04tPz+/0etYu3atU/vDH/7g1NQ3MnxveKHWMW7cOKfWo0cPp/bII484NRXQ/MQTTzi1/fv3e40P6Zepc/Bll13m1C688EKnpq41LFmypEnGlEoqXF8FcB96beWgysrKJhhR00j6gtK8efPqDppZWVn26quv2quvviqXPe6442zq1KnhRvj/KykpsaKiIps7d25d41RXV9vixYvlHQ4ARAs9DMQX/QvEGz0MxBf9iyhL+oLSbbfdZhMmTLAgCKygoMCefvpp55MoWVlZ1qFDh6RvYbhjx46EK5Br1qyxjz76yLp37259+vSxm2++2R588EH73ve+V3e7xOLiYhs5cmSymwGgCdDDQHzRv0C80cNAfNG/iKukLyi1b9/e2rdvb2bf7ug9evSwDh06pGQwS5YssXPOOafu3xMnTjQzs7Fjx9qMGTPstttus507d9q4ceOssrLSzjjjDJszZ07SF64ANA16GIgv+heIN3oYiC/6F3GV9AWlQ/Xt2zdV4zAzs7PPPtuCIGjw91lZWXb//ffb/fffn9L1AkgNehiIL/oXiDd6GIgv+hdxFeqCUklJiWVlZX3nMllZWbZ69eowq0EMFBQUOLUnn3zSqbVq5d5YUB0Yt23blpqBATEye/Zsp3b++ed7Pfa5555zanfddVfYIQFoJr43MVEhvEBL1KaN+2dMmABuddOKK664wqlt2bKl0etQVCj35MmTndqUKVOcmvqWiDpGvP76606Nv8+QbmPGjHFqap9Wf1NGjbpJwI9+9COnduDAAaf24IMPOrU4heaHuqB01llnOReUDhw4YGvXrrX333/fBg4caCeddFKoAQIAAAAAACBaQl1QmjFjRoO/+/jjj2348OHyyhwAAAAAAADiy/3+UYoMGjTIfvzjH9vPfvazploFAAAAAAAA0qDJLiiZmRUWFtrKlSubchUAAAAAAABoZqG+8vZdtm7das8884z16tWrqVaBCCkrK3NqPXr0cGrbt293aqtWrWqSMQFR1rNnT6f2D//wD04tJyfHqalAUBXot2PHjkaODkBTOu2005zaNddc49SWLVvm1N5+++0mGRPQkixZssSpXXvttU4t1QHcvlSItooRGTJkSHMMBwgtNzfXqam5UHnqqadSPZyUGzdunFNTNwn49NNPndq8efOaZEzNJdQFpXPPPVfWKysr7W9/+5vt27fPfve734VZBQAAAAAAACIm1AWl2tpa5y5vWVlZVlJSYqWlpXbttdfagAEDQg0QAAAAAAAA0RLqgtK7776bomEAAAAAAAAgLpo0lBsAAAAAAACZJ3Qo9+bNm+3//J//Y2+99ZZ9+eWXZmZ25JFH2oUXXmg//elPrbCwMOwqEDGnn366U/v5z3/u9diRI0c6tRUrVoQdEhA7f/jDH5xaXl6e12P/7d/+zamtXr069JgANI/S0lKn1r17d6c2Z84cp7Znz54mGROQCVq18vt/5aeeemoTjySc+pEiZnrbfLf33nvvdWr/63/9r6THBTSWusnMEUcc4dReeOGF5hhOyh111FFey2Xi372hPqH0ySef2PHHH29Tpkyx3NxcGzNmjI0ZM8Zyc3NtypQpdsIJJ2TkiwYAAAAAANCShfqEUllZmR04cMAWL17s3Lbygw8+sAsvvNBuvPHG2N8KDwAAAAAAAP8t1CeUPvjgA7vpppuci0lmZkOHDrWbbrrJFi9eHGYVAAAAAAAAiJhQF5QKCgqsXbt2Df6+Xbt2VlBQEGYVAAAAAAAAiJhQX3m7+eabberUqXbVVVdZUVFRwu82bNhgTz31lN18881hVoEIuvDCC51a27ZtndrcuXOd2sKFC5tkTECUXXzxxU7t5JNP9nrsu+++69TuueeesEMCkEaDBg1yakEQOLVXXnmlOYYDxNL111/v1Gpra9MwktQbMWKEUzvppJOcmtpeVVOh3EBzqqmpcWofffSRUzvhhBOcmrppxbZt21IyrsZQH5i57LLLvB773nvvpXo4aRfqglJtba116tTJ+vfvb5deeqn179/fzMw+++wzmz17tvXv399qa2ttypQpdY/JysqyW265JdyoAQAAAAAAkDahLijdeuutdf/97//+787vly9fnrCMGReUAAAAAAAA4i7UBaU1a9akahwAAAAAAACIiVAXlPr27ZuqcQAAAAAAACAmQl1QQuZr3769U/vHf/xHp7Zv3z6npoKD9+/fn5qBARGVl5fn1O644w6npoLsFRVYuGPHjqTHBSA96t+0xMzsBz/4gVNbtWqVU5s1a1aTjAnIBCq4Oup69Ojh1I477jinps4bfG3evNmpcf6NdNu9e7dTW716tVMbPXq0U/vjH//o1A7NaE6FgQMHynq/fv2c2pFHHunU1I01lEy5ccChWoV5cBAE9pvf/MaGDh1q+fn51rp1a+enTRuuWQEAAAAAAGSSUFd7brvtNpsyZYqdeOKJdtVVV1m3bt1SNS4AAAAAAABEVKgLSjNnzrTRo0fb73//+1SNBwAAAAAAABEX6itvu3fvttLS0lSNBQAAAAAAADEQ6hNK5513nv3lL3+xcePGpWo8iJif/vSnTu2kk05yanPmzHFq/+///b8mGRMQZf/yL//i1IYMGeL12NmzZzs1FW4PID6uvvpqp1ZQUODU/uM//qMZRgMgne68806nVlZW1ujn+/LLL53a2LFjndq6desavQ6gqahz3KysLKf2wx/+0Km98MILKR3Lli1bZF2Fbefn5zd6PTNmzGj0Y6Mq1CeUnnzySVu0aJH94he/sK1bt6ZqTAAAAAAAAIiwUBeUjjnmGPviiy9s0qRJVlBQYB07drQuXbok/OTm5qZqrAAAAAAAAIiAUF95Gz16tPxYGgAAAAAAADJXqAtKmfgdQAAAAAAAAHy3pC8offjhh0mv5OSTT076MWh+KvBs0qRJTq26utqp3X///U0yJiBuJk6c2OjHTpgwwant2LEjzHAApFnfvn29ltu+fXsTjwRAc3rrrbec2jHHHJPSdaxcudKpvffeeyldB9BU/va3vzm1f/qnf3JqJ554olPr379/SsfyyiuveC87c+ZMp/aj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\n"
          },
          "metadata": {}
        }
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "id": "7a4bbf80"
      },
      "source": [
        "def train_epoch(model, dataloader, optimizer, device):\n",
        "    model.train()\n",
        "    total_loss = 0\n",
        "    for i, (x, _) in enumerate(dataloader):\n",
        "        x = x.to(device)\n",
        "        optimizer.zero_grad()\n",
        "        z, x_hat, mu, log_var, z_hat = model(x)\n",
        "        recon_loss = F.binary_cross_entropy_with_logits(x_hat, x, reduction='sum')\n",
        "        kl_loss = -0.5 * torch.sum(1 + log_var - mu.pow(2) - log_var.exp())\n",
        "        loss = recon_loss + kl_loss\n",
        "        loss.backward()\n",
        "        optimizer.step()\n",
        "        total_loss += loss.item()\n",
        "    return total_loss / len(dataloader.dataset)"
      ],
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "source": [
        "device = 'cuda' if torch.cuda.is_available() else 'mps' if torch.backends.mps.is_available() else 'cpu'\n",
        "neanderthal_sub = SubmissionInterface().to(device) # loads vae and flow models\n",
        "xhat_gen = neanderthal_sub.generate_samples(n_samples=10, n_steps=100)"
      ],
      "metadata": {
        "id": "RdIv1JZZMdd4"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "source": [],
      "metadata": {
        "id": "4C37fBbOCBtO"
      }
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "e7b0960c"
      },
      "source": [
        "# Task\n",
        "Train the VAE model without using the PyTorch Lightning Module."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "77cfda3e"
      },
      "source": [
        "## Define training function\n",
        "\n",
        "### Subtask:\n",
        "Create a function that performs one training epoch. This function will iterate over the training dataloader, perform the forward pass, calculate the loss (reconstruction loss and KL divergence), perform backpropagation, and update the model's weights.\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "3a38052a"
      },
      "source": [
        "**Reasoning**:\n",
        "The goal is to create a function for a single training epoch of the VAE model. This involves iterating through the dataloader, performing the forward pass, calculating the loss components (reconstruction and KL divergence), and executing the optimization step. The provided code block will implement this function according to the instructions.\n",
        "\n"
      ]
    }
  ]
}